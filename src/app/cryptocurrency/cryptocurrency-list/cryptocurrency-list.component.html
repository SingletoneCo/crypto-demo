<!--
Webstorm doesn't support this syntax yet ;(
@if (cryptocurrencies$ | async; as cryptocurrencies) {

} else {}
-->

<ng-container *ngIf="cryptocurrencies$ | async as cryptocurrencies">
  <table mat-table [dataSource]="cryptocurrencies">

    <ng-container matColumnDef="favourite">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        <div (click)="toggleFavouriteProperty(element.id)">
          <!--@if (element.favourite) {
          <mat-icon aria-hidden="false" aria-label="Example home icon" fontIcon="star" class="favourite-icon"></mat-icon>
          } else {
          <mat-icon aria-hidden="false" aria-label="Example home icon" fontIcon="star_border" class="favourite-icon"></mat-icon>
          }-->

          <ng-container *ngIf="element.favourite; else notFavourite">
            <mat-icon aria-hidden="false" aria-label="Example home icon" fontIcon="star" class="favourite-icon"></mat-icon>
          </ng-container>
          <ng-template #notFavourite>
            <mat-icon aria-hidden="false" aria-label="Example home icon" fontIcon="star_border" class="favourite-icon"></mat-icon>
          </ng-template>

        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="rank">
      <th mat-header-cell *matHeaderCellDef>#</th>
      <td mat-cell *matCellDef="let element">{{ element.rank }}</td>
    </ng-container>

    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Name</th>
      <td mat-cell *matCellDef="let element">
        <img src="/assets/icons/cryptoicons/{{ element.symbol | lowercase }}.svg" alt="icon" class="cryptoicon" />
        <span class="element-name">{{ element.name }}</span>
        <span class="cryptocurrency-symbol">{{ element.symbol }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="price">
      <th mat-header-cell *matHeaderCellDef class="align-right">Price</th>
      <td mat-cell *matCellDef="let element" class="align-right">{{ element.quotes.USD.price | currency }}</td>
    </ng-container>

    <ng-container matColumnDef="hour">
      <th mat-header-cell *matHeaderCellDef class="align-right">1h%</th>
      <td mat-cell *matCellDef="let element" class="align-right">{{ element.quotes.USD.percent_change_1h | percent }}</td>
    </ng-container>

    <ng-container matColumnDef="day">
      <th mat-header-cell *matHeaderCellDef class="align-right">24h%</th>
      <td mat-cell *matCellDef="let element" class="align-right">{{ element.quotes.USD.percent_change_24h | percent }}</td>
    </ng-container>

    <ng-container matColumnDef="week">
      <th mat-header-cell *matHeaderCellDef class="align-right">7d%</th>
      <td mat-cell *matCellDef="let element" class="align-right">{{ element.quotes.USD.percent_change_7d | percent }}</td>
    </ng-container>

    <ng-container matColumnDef="marketCap">
      <th mat-header-cell *matHeaderCellDef class="align-right">Market Cap</th>
      <td mat-cell *matCellDef="let element" class="align-right">{{ element.quotes.USD.market_cap }}</td>
    </ng-container>

    <ng-container matColumnDef="volumeDay">
      <th mat-header-cell *matHeaderCellDef class="align-right">Volume (24h)</th>
      <td mat-cell *matCellDef="let element" class="align-right">{{ element.quotes.USD.volume_24h }}</td>
    </ng-container>

    <ng-container matColumnDef="circulatingSupply">
      <th mat-header-cell *matHeaderCellDef class="align-right">Circulating Supply</th>
      <td mat-cell *matCellDef="let element" class="align-right">{{ element.circulating_supply | number }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</ng-container>

